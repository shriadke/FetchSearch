[2023-10-10 15:32:01,201: INFO: server: Started server process [1680]]
[2023-10-10 15:32:01,203: INFO: on: Waiting for application startup.]
[2023-10-10 15:32:01,204: INFO: on: Application startup complete.]
[2023-10-10 15:32:01,205: INFO: server: Uvicorn running on http://0.0.0.0:8080 (Press CTRL+C to quit)]
[2023-10-10 15:32:43,611: INFO: main: This Project uses custom logger.
]
[2023-10-10 15:32:43,612: INFO: main: #################################
]
[2023-10-10 15:32:51,423: INFO: main: ######## Stage Data Ingestion Stage started. ########]
[2023-10-10 15:32:51,431: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-10-10 15:32:51,443: INFO: common: yaml file: params.yaml loaded successfully]
[2023-10-10 15:32:51,443: INFO: common: created directory at: artifacts]
[2023-10-10 15:32:51,443: INFO: common: created directory at: artifacts/data_ingestion]
[2023-10-10 15:32:51,443: INFO: data_ingestion: File already exists of size: ~ 230 KB]
[2023-10-10 15:32:51,480: INFO: main: ######## Stage Data Ingestion Stage completed. ########

################################################]
[2023-10-10 15:32:51,481: INFO: main: ######## Stage Data Validation Stage started. ########]
[2023-10-10 15:32:51,487: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-10-10 15:32:51,491: INFO: common: yaml file: params.yaml loaded successfully]
[2023-10-10 15:32:51,492: INFO: common: created directory at: artifacts]
[2023-10-10 15:32:51,493: INFO: common: created directory at: artifacts/data_validation]
[2023-10-10 15:32:51,497: INFO: main: ######## Stage Data Validation Stage completed. ########

################################################]
[2023-10-10 15:32:51,498: INFO: main: ######## Stage Data Transformation Stage started. ########]
[2023-10-10 15:32:51,506: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-10-10 15:32:51,509: INFO: common: yaml file: params.yaml loaded successfully]
[2023-10-10 15:32:51,510: INFO: common: created directory at: artifacts]
[2023-10-10 15:32:51,511: INFO: common: created directory at: artifacts/data_transformation]
[2023-10-10 15:32:52,380: INFO: data_transformation: in train, We have a <class 'list'> of length 7314 containing <class 'sentence_transformers.readers.InputExample.InputExample'>'s.]
[2023-10-10 15:32:52,482: INFO: data_transformation: in val, We have a <class 'list'> of length 4 containing <class 'sentence_transformers.readers.InputExample.InputExample'>'s.]
[2023-10-10 15:32:52,485: INFO: data_transformation: in test, We have a <class 'list'> of length 4 containing <class 'sentence_transformers.readers.InputExample.InputExample'>'s.]
[2023-10-10 15:32:52,492: INFO: main: ######## Stage Data Transformation Stage completed. ########

################################################]
[2023-10-10 15:32:52,492: INFO: main: ######## Stage Model Trainer stage started. ########]
[2023-10-10 15:32:52,492: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-10-10 15:32:52,499: INFO: common: yaml file: params.yaml loaded successfully]
[2023-10-10 15:32:52,499: INFO: common: created directory at: artifacts]
[2023-10-10 15:32:52,499: INFO: common: created directory at: artifacts/model_trainer]
[2023-10-10 15:32:52,503: INFO: SentenceTransformer: Load pretrained SentenceTransformer: msmarco-distilbert-base-v4]
[2023-10-10 15:32:54,484: INFO: SentenceTransformer: Use pytorch device: cpu]
[2023-10-10 15:32:58,627: INFO: EmbeddingSimilarityEvaluator: EmbeddingSimilarityEvaluator: Evaluating the model on  dataset after epoch 0:]
[2023-10-10 15:32:59,122: INFO: EmbeddingSimilarityEvaluator: Cosine-Similarity :	Pearson: 0.8606	Spearman: 0.9487]
[2023-10-10 15:32:59,123: INFO: EmbeddingSimilarityEvaluator: Manhattan-Distance:	Pearson: 0.8949	Spearman: 0.9487]
[2023-10-10 15:32:59,124: INFO: EmbeddingSimilarityEvaluator: Euclidean-Distance:	Pearson: 0.8856	Spearman: 0.9487]
[2023-10-10 15:32:59,124: INFO: EmbeddingSimilarityEvaluator: Dot-Product-Similarity:	Pearson: 0.8502	Spearman: 0.9487]
[2023-10-10 15:32:59,127: INFO: SentenceTransformer: Save model to artifacts/model_trainer\saved-search-model]
[2023-10-10 15:32:59,986: INFO: main: ######## Stage Model Trainer stage completed. ########

################################################]
[2023-10-10 15:32:59,987: INFO: main: ######## Stage Model Evaluation stage started. ########]
[2023-10-10 15:33:00,000: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-10-10 15:33:00,009: INFO: common: yaml file: params.yaml loaded successfully]
[2023-10-10 15:33:00,011: INFO: common: created directory at: artifacts]
[2023-10-10 15:33:00,012: INFO: common: created directory at: artifacts/model_evaluation]
[2023-10-10 15:33:00,013: INFO: SentenceTransformer: Load pretrained SentenceTransformer: msmarco-distilbert-base-v4]
[2023-10-10 15:33:01,626: INFO: SentenceTransformer: Use pytorch device: cpu]
[2023-10-10 15:33:03,309: INFO: CrossEncoder: Use pytorch device: cpu]
[2023-10-10 15:33:03,406: INFO: model_evaluation: Val accuracy with cross-encoders : 98.7500003632158]
[2023-10-10 15:33:03,418: INFO: main: ######## Stage Model Evaluation stage completed. ########

################################################]
[2023-10-10 15:35:11,417: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-10-10 15:35:11,420: INFO: common: yaml file: params.yaml loaded successfully]
[2023-10-10 15:35:11,421: INFO: common: created directory at: artifacts]
[2023-10-10 15:35:11,422: INFO: common: created directory at: artifacts/model_evaluation]
[2023-10-10 15:35:11,445: INFO: SentenceTransformer: Load pretrained SentenceTransformer: msmarco-distilbert-base-v4]
[2023-10-10 15:35:12,551: INFO: SentenceTransformer: Use pytorch device: cpu]
[2023-10-10 15:35:13,196: INFO: prediction: Searched for:walmart]
[2023-10-10 15:35:13,197: INFO: prediction: Getting all available offers!!]
[2023-10-10 15:35:13,220: INFO: prediction: Found all available offers!!]
[2023-10-10 15:35:13,221: INFO: prediction: Filtering duplicate offers!!]
[2023-10-10 15:35:14,295: INFO: CrossEncoder: Use pytorch device: cpu]
[2023-10-10 15:35:15,325: INFO: prediction: Removed duplicate offers!!]
[2023-10-10 15:35:15,326: INFO: prediction: Re-Ranking available offers!!]
[2023-10-10 15:35:15,504: INFO: prediction: Re-Ranking Done!!]
[2023-10-10 15:35:15,505: INFO: prediction: 	1.43	Arber, at Walmart	]
[2023-10-10 15:35:15,505: INFO: prediction: 	1.0	Burt's Bees® products, select varieties, at Walmart	]
[2023-10-10 15:35:15,506: INFO: prediction: 	0.22999999999999998	Little Bites® Spend $10 at Walmart®	]
[2023-10-10 15:35:15,507: INFO: prediction: 	0.2	Tyson Products, select varieties, spend $15 at Walmart	]
[2023-10-10 15:35:15,507: INFO: prediction: 	0.19	Burt's Bees Sensitive Lotions and Creams, select varieties, at Walmart	]
[2023-10-10 15:52:34,755: INFO: server: Shutting down]
[2023-10-10 15:52:34,870: INFO: on: Waiting for application shutdown.]
[2023-10-10 15:52:34,870: INFO: on: Application shutdown complete.]
[2023-10-10 15:52:34,870: INFO: server: Finished server process [1680]]
